# Huet_etal_PLOSCompBio_2022_dataFiles

This repository serves as a source location for the data files associated with the paper "Demonstration of three-dimensional contact point determination and contour reconstruction during active whisking behavior of an awake rat" accepted to PLOS Computational Biology May 2022. 

Authors: Lucie A. Huet*, Hannah M. Emnett*, Mitra J. Z. Hartmann

*Authors contributed equally

Abstract: The rodent vibrissal (whisker) system has been studied for decades as a model of active touch sensing. There are no sensors along the length of a whisker; all sensing occurs at the whisker base. Therefore, a large open question in many neuroscience studies is how an animal could estimate the three-dimensional location at which a whisker makes contact with an object. In the present work we simulated the shape of a real rat whisker to demonstrate the existence of several unique mappings from triplets of mechanical signals at the whisker base to the three-dimensional whisker-object contact point. We then used high speed video to record whisker deflections as an awake rat whisked against a peg, and used the mechanics resulting from those deflections to extract the contact points along the peg surface. These results demonstrate that measurement of specific mechanical triplets at the base of a biological whisker can enable 3D contact point determination during natural whisking behavior. The approach is viable even though the biological whisker has non-ideal, non-planar curvature, and even given the rat’s real-world choices of whisking parameters. Visual intuition for the quality of the approach is provided in a video that shows the contour of the peg gradually emerging during active whisking behavior.

Acknowledgements: Sponsored by R01-NS093585 to MJZH. HME was partially supported by the National Science Foundation Graduate Research Fellowship Program under Grant number DGE-1324585. The funders had no role in study design, data collection and analysis, decision to publish, or preparation of the manuscript.

Citation: TBA

## Supplementary Information 
[S1 Video:](SV1_v4_compressed.avi) The 3D contact point (rwobj, θwobj, ϕwobj) can be determined from the signals FX, MB, MD during active whisking. (Top) The signals FX, MB, and MD vary with time as the rat whisks against the peg. The sudden change in MD occurs when the rat switches from whisking forward to whisking backward against the peg. (Middle) Each of the three panels shows the mapping between the signals FX, MB, and MD (variables on the axes) and one of the three geometric coordinates rwobj, θwobj, and ϕwobj (represented with a colormap). Each mapping is a solid and is drawn as a set of semi-transparent monochromatic layers to aid visualization. In each panel, the trajectory of the black dot represents the changing values of the FX, MB, and MD signals shown in the Top subplot of the video. At each instant of time, the color at the location of the black dot in the three panels indicates the 3D contact point coordinates. (Bottom) The geometric coordinates (rwobj, θwobj, ϕwobj) generated by the mappings shown in the Middle subplot.

[S2 Video:](SV2_v1.mp4) The rwobj, θwobj, ϕwobj coordinates computed from the mechanical signals at the whisker base can be used to reconstruct the shape of the peg. (Top left) This panel shows a still image of the rat’s head, the peg location, and the tracked whisker (red). This still image can be compared with the videos in the other panels, all of which show different views of the peg “reconstruction” over time. (Top center) The time-varying 3D whisker-object contact point (rwobj, θwobj, ϕwobj) computed from the mechanical signals is plotted in whisker-centered coordinates. The whisker is the black, tapered, dotted line. Each magenta dot represents a 3D contact point on the peg with respect to the whisker. Each dot is computed based on mechanical data obtained from a single video frame (1 ms resolution). These are the identical points plotted in all other video panels, but are now plotted in their correct 3D spatial locations relative to the whisker. (Top right) Top-down view and front-on view of the rat as it whisks against the peg. The rat first whisks forward against the back of the peg, and then whisks backwards against the front of the peg. The whisker is traced in red for those frames in which it is in contact with the peg. (Bottom row) All videos in the bottom row show the gradual reconstruction of the peg’s contour based on computing contact points from the mechanical signals at the whisker base. Because the rat whisks both forward and backwards against the peg, reconstructions are observed for the peg’s front and back sides. Contact points directly tracked from the video (“ground truth”) are shown as black dots. Contact points computed from mechanical signals are shown as transparent magenta dots. (Bottom left and center) The left panel shows an isometric view of the rat’s head along with the time-varying whisker-peg contact points, while the center panel shows an expanded view of the contact points. Note that the contact points form two distinct vertical lines, indicating contact with the front and the back of the peg. (Bottom right) Reconstruction of the peg contour in top-down and front-on views, matching the videos directly above. The top-down view reveals that the largest errors are found in the estimate of radial distance, rather than in estimates of the angles of contact. 

[S1_Text:](S1_Text.pdf) Supplementary Methods

## Elastica3D and rat head model 
Please find Elastica 3D and the rat head model available with all Digital Rat files at: https://github.com/SeNSE-lab/DigitalRat/

## Figure Data
File A: [Huet_PLOSCB2022_figureData_part1](Huet_PLOSCB2022_figureData_part1.mat)

File B: [Huet_PLOSCB2022_figureData_part2](Huet_PLOSCB2022_figureData_part2.mat)

Video A: [High-speed video](VideoA.mp4) of rat whisking into peg. White square indicates time when the whisker is in contact. 

### Relevant Variables by Figure for the main text
Fig 1: N/A

Fig 2: gamma_undeflected, mapping_FX, mapping_FD, mapping_FT, mapping_MX, mapping_MB, mapping_MD, mapping_R, mapping_TH, mapping_PHI, mapping_POSx, mapping_POSy, mapping_POSz

Fig 3: gamma_undeflected, mapping_FX, mapping_FD, mapping_FT, mapping_MX, mapping_MB, mapping_MD, mapping_R, mapping_TH, mapping_PHI, mapping_POSx, mapping_POSy, mapping_POSz

Fig 4: mapping_FX, mapping_FD, mapping_FT, mapping_MX, mapping_MB, mapping_MD, mapping_R, mapping_TH, mapping_PHI, predicted_rtp_wobj, tracked_rtp_wobj, tracked_MD, tracked_MB, tracked_FX, tracked_filt_MD, tracked_filt_MB, tracked_filt_FX

Fig 5: sens_jac, sens_color, sens_pos

Fig 6: gamma_undeflected, predicted_cp_world, predicted_cp_wobj, tracked_cp_world, predicted_rtp_wobj, tracked_rtp_wobj, tracked_basepoint, tracked_emergence

### Relevant Variables by Figure for S1 Text
Fig A: N/A

Fig B: gamma_undeflected, gamma_deflected

Fig C: mapping_ER, mapping_FX, mapping_FD, mapping_FT, mapping_MX, mapping_MB, mapping_MD, mapping_R, mapping_TH, mapping_PHI, mapping_POSx, mapping_POSy, mapping_POSz
